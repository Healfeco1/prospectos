(this.webpackJsonpconcredito=this.webpackJsonpconcredito||[]).push([[0],{250:function(e,t,a){},252:function(e,t,a){},256:function(e,t,a){"use strict";a.r(t);var c=a(1),n=a.n(c),s=a(25),o=a.n(s),r=a(122),l=a(33),i=a(23),d=a(26),b=a(15),j=a(13),m=a(10),u=a(24);u.a.initializeApp({apiKey:"AIzaSyAkxZMP6KJnsCKFqGbgOpZuBwHfb-ysy3c",authDomain:"concredito-f5512.firebaseapp.com",databaseURL:"https://concredito-f5512-default-rtdb.firebaseio.com",projectId:"concredito-f5512",storageBucket:"concredito-f5512.appspot.com",messagingSenderId:"877734757930",appId:"1:877734757930:web:ed8bb0372f15bb8819e553",measurementId:"G-7K32XWFZ1F"}),u.a.analytics(),u.a.auth();u.a;var O=function(e){var t=[];u.a.database().ref("prospectos").once("value",(function(a){var c=a.val();if(c)for(var n=0,s=Object.entries(c);n<s.length;n++){var o=s[n],r=Object(b.a)(Object(b.a)({},o[1]),{},Object(d.a)({},"id",o[0]));t.push(r),e(t)}}))},p=function(e,t){var a={};return u.a.database().ref("prospectos/".concat(e)).once("value").then((function(e){var c=e.val();t(c),a=c})),a},x=function(e,t){JSON.stringify(t);var a=u.a.database().ref("/prospectos/".concat(t));Object.entries(e).map((function(e){console.log(e),a.update(Object(d.a)({},e[0],e[1]))}))},f=function(e){console.log(e.documentos),e.status="Enviado";var t=u.a.database().ref("prospectos").push(e).key;e.documentos&&Object.values(e.documentos).map((function(a,c){var n=a.documento,s=u.a.storage().ref(),o="";o=n.name?t+"/"+n.name:t+"/"+e.documentos.nombre,console.log(n.name);var r=s.child(o).put(n);r.on("",(function(e){}),(function(e){}),(function(){r.snapshot.ref.getDownloadURL().then((function(e){console.log("File available at",e),u.a.database().ref("prospectos/"+t+"/documentos/"+c+"/documento").set(e)}))}))}))},h=a(4);function v(e){var t=Object(c.useState)([]),a=Object(j.a)(t,2),n=a[0],s=a[1],o=Object(c.useState)(!1),r=Object(j.a)(o,2),l=r[0],i=r[1],d=Object(c.useState)(),b=Object(j.a)(d,2),m=b[0],u=b[1],v=Object(c.useState)(),N=Object(j.a)(v,2),P=N[0],S=N[1],y=function(){O(s)};return Object(c.useEffect)((function(){!function(e){switch(e){case"visualizar":u("DATOS DEL PROSPECTO");break;case"evaluar":u("EVALUACI\xd3N DEL PROSPECTO");break;case"nuevo":u("CAPTURA DE NUEVO PROSPECTO")}}(P)}),[P]),Object(h.jsx)(g.Provider,{value:{getAllProspects:y,resProspectos:[],prospectos:n,getDataIdProspecto:function(e,t){p(e,t)},handledSaveProspect:function(e){f(e),y()},handledUpdateProspect:function(e,t){x(e,t)},sethandleShowModal:i,handleShowModal:l,titleModal:m,prospectoAccion:P,setProspectoAccion:S},children:e.children})}var g=n.a.createContext(),N=a(85),P=a(117),S=a(2),y=a(31);function C(e){var t=e.idProspecto,a=e.sethandleShowModal,n=Object(c.useContext)(g),s=n.getDataIdProspecto,o=n.handledSaveProspect,r=n.handledUpdateProspect,u=n.prospectoAccion,O=Object(c.useState)({nombreProspecto:"",primerApellido:"",segundoApellido:"",calle:"",numero:"",colonia:"",codigoPostal:"",telefono:"",rfc:"",observaciones:"",status:"",documentos:""}),p=Object(j.a)(O,2),x=p[0],f=p[1],v=Object(c.useRef)(x),C=Object(c.useState)([]),A=Object(j.a)(C,2),w=A[0],F=A[1],E=Object(l.useToasts)().addToast,B=Object(c.useState)(0),T=Object(j.a)(B,2),k=T[0],R=T[1],D=Object(c.useState)([]),z=Object(j.a)(D,2),I=z[0],M=z[1],H=Object(c.useState)([]),L=Object(j.a)(H,2),U=L[0],_=L[1],J=Object(c.useState)([]),K=Object(j.a)(J,2);K[0],K[1];Object(c.useEffect)((function(){t&&s(t,f)}),[]);function q(e){var t;return e||(t="Campo Requerido"),t}Object(c.useEffect)((function(){}),[k]);var G=function(e){var t="documentoName".concat(k-1),a="documento".concat(k-1);if(e.target.name==t&&_(Object(b.a)(Object(b.a)({},U),{},Object(d.a)({},k-1,{nombre:e.target.value}))),e.target.name==a){_(Object(b.a)(Object(b.a)({},U),{},Object(d.a)({},k-1,Object(b.a)(Object(b.a)({},U[k-1]),{},{documento:e.target.files[0]}))))}var c=w,n=Object(b.a)(Object(b.a)({},c),{},Object(d.a)({},e.target.name,e.target.value));F(n)};Object(c.useEffect)((function(){console.log(U)}),[U]);return Object(c.useEffect)((function(){}),[v.current]),Object(h.jsx)(h.Fragment,{children:Object(h.jsx)(m.d,{innerRef:v,enableReinitialize:!0,initialValues:x,onSubmit:function(e,t){return function(e,t,c){e=Object(b.a)(Object(b.a)({},e),{},{documentos:U}),o(e),a(!1),t()}(e,t.resetForm)},validationSchema:N.a({telefono:N.b().max(10,"Este campo solo acepta mximo 10 caracteres")}),children:Object(h.jsxs)(m.c,{children:[Object(h.jsxs)("div",{className:"col-md-10 mb-3 d-flex justify-content-between",children:[Object(h.jsxs)("div",{children:[Object(h.jsx)("label",{htmlFor:"status",className:"mr-2",children:"Estatus"}),Object(h.jsx)(m.b,{name:"status",type:"text",className:"text-white text-center ".concat("Autorizado"==x.status?"bg-success":"Rechazado"==x.status?"bg-danger":"Enviado"==x.status?"bg-secondary":""),disabled:!0})]}),"evaluar"==u?Object(h.jsxs)("div",{className:"col-md-8",children:[Object(h.jsx)(y.a,{variant:"outline-success btn-sm mr-2",onClick:function(){return function(){var e=Object(b.a)(Object(b.a)({},w),{},{status:"Autorizado"});r(e,t),s(t,f)}()},children:"Autorizar"}),Object(h.jsx)(y.a,{variant:"outline-danger btn-sm",onClick:function(){return function(){if(0==x.observaciones.length)w.observaciones||E("Captura el campo: Observaciones, es obligatorio *",{appearance:"error",autoDismiss:!0});else{var e=Object(b.a)(Object(b.a)({},w),{},{status:"Rechazado"});r(e,t),s(t,f),F([])}}()},children:"Rechazar"})]}):""]}),Object(h.jsxs)("div",{className:"form-row m-1",children:[Object(h.jsxs)("div",{className:"col-md-4 mb-3",children:[Object(h.jsxs)("label",{htmlFor:"nombreProspecto",children:["Nombre del prospecto",Object(h.jsx)("b",{className:"text-danger",children:"*"})]}),Object(h.jsx)(m.b,{name:"nombreProspecto",type:"text",className:"form-control",validate:q,onBlur:function(e){return G(e)},disabled:""!=x.status?"disabled":""}),Object(h.jsx)(m.a,{name:"nombreProspecto",component:"span",className:"text-danger"})]}),Object(h.jsxs)("div",{className:"col-md-4 mb-3",children:[Object(h.jsxs)("label",{htmlFor:"primerApellido",children:["Primer apellido",Object(h.jsx)("b",{className:"text-danger",children:"*"})]}),Object(h.jsx)(m.b,{name:"primerApellido",type:"text",className:"form-control",validate:q,onBlur:function(e){return G(e)},disabled:""!=x.status?"disabled":""}),Object(h.jsx)(m.a,{name:"primerApellido",component:"span",className:"text-danger"})]}),Object(h.jsxs)("div",{className:"col-md-4 mb-3",children:[Object(h.jsx)("label",{htmlFor:"segundoApellido",children:"Segundo Apellido"}),Object(h.jsx)(m.b,{name:"segundoApellido",type:"text",className:"form-control",onBlur:function(e){return G(e)},disabled:""!=x.status?"disabled":""})]}),Object(h.jsxs)("div",{className:"col-md-5 mb-3",children:[Object(h.jsxs)("label",{htmlFor:"calle",children:["Calle",Object(h.jsx)("b",{className:"text-danger",children:"*"})]}),Object(h.jsx)(m.b,{name:"calle",type:"text",className:"form-control",validate:q,onBlur:function(e){return G(e)},disabled:""!=x.status?"disabled":""}),Object(h.jsx)(m.a,{name:"calle",component:"span",className:"text-danger"})]}),Object(h.jsxs)("div",{className:"col-md-3 mb-3",children:[Object(h.jsxs)("label",{htmlFor:"numero",children:["N\xfamero",Object(h.jsx)("b",{className:"text-danger",children:"*"})]}),Object(h.jsx)(m.b,{name:"numero",type:"number",className:"form-control",validate:q,onBlur:function(e){return G(e)},disabled:""!=x.status?"disabled":""}),Object(h.jsx)(m.a,{name:"numero",component:"span",className:"text-danger"})]}),Object(h.jsxs)("div",{className:"col-md-4 mb-3",children:[Object(h.jsxs)("label",{htmlFor:"colonia",children:["Colonia",Object(h.jsx)("b",{className:"text-danger",children:"*"})]}),Object(h.jsx)(m.b,{name:"colonia",type:"text",className:"form-control",validate:q,onBlur:function(e){return G(e)},disabled:""!=x.status?"disabled":""}),Object(h.jsx)(m.a,{name:"colonia",component:"span",className:"text-danger"})]}),Object(h.jsxs)("div",{className:"col-md-3 mb-3",children:[Object(h.jsxs)("label",{htmlFor:"codigoPostal",children:["CP",Object(h.jsx)("b",{className:"text-danger",children:"*"})]}),Object(h.jsx)(m.b,{name:"codigoPostal",type:"number",className:"form-control",validate:q,onBlur:function(e){return G(e)},disabled:""!=x.status?"disabled":""}),Object(h.jsx)(m.a,{name:"codigoPostal",component:"span",className:"text-danger"})]}),Object(h.jsxs)("div",{className:"col-md-4 mb-3",children:[Object(h.jsxs)("label",{htmlFor:"telefono",children:["Tel\xe9fono",Object(h.jsx)("b",{className:"text-danger",children:"*"})]}),Object(h.jsx)(m.b,{name:"telefono",type:"number",className:"form-control",validate:q,onBlur:function(e){return G(e)},disabled:""!=x.status?"disabled":"",maxLength:"10"}),Object(h.jsx)(m.a,{name:"telefono",component:"span",className:"text-danger"})]}),Object(h.jsxs)("div",{className:"col-md-5 mb-3",children:[Object(h.jsxs)("label",{htmlFor:"rfc",children:["RFC",Object(h.jsx)("b",{className:"text-danger",children:"*"})]}),Object(h.jsx)(m.b,{name:"rfc",type:"text",className:"form-control",validate:q,onBlur:function(e){return G(e)},disabled:""!=x.status?"disabled":""}),Object(h.jsx)(m.a,{name:"rfc",component:"span",className:"text-danger"})]}),Object(h.jsxs)("div",{className:"col-12 mb-3",children:[Object(h.jsx)("label",{htmlFor:"documentos",children:"Documentos"}),Object(h.jsx)(S.b.Provider,{value:{size:"1em",className:"mb-2"},children:Object(h.jsx)("span",{onClick:function(e){return function(e){var t;e.preventDefault(),Object(b.a)(Object(b.a)({},x),{},(t={},Object(d.a)(t,"documentoName".concat(k),""),Object(d.a)(t,"documento".concat(k),""),t));var a=[].concat(Object(i.a)(I),[k]);M(a),R(k+1)}(e)},children:""!=x.status?"":Object(h.jsx)(P.a,{})})})]}),Object(h.jsxs)("div",{className:"col-md-12 mb-3",children:[I.map((function(e){return Object(h.jsxs)("span",{className:"form-row mb-3 d-flex align-items-center text-center",children:[Object(h.jsxs)("div",{className:"form-row col-md-6 mb-3 ml-5",children:[Object(h.jsxs)("label",{htmlFor:"documentoName".concat(e),children:["Nombre del documento",Object(h.jsx)("b",{className:"text-danger",children:"*"})]}),Object(h.jsx)(m.b,{name:"documentoName".concat(e),type:"text",className:"form-control",validate:q,onBlur:function(e){return G(e)}}),Object(h.jsx)(m.a,{name:"documentoName".concat(e),component:"span",className:"text-danger"})]}),Object(h.jsxs)("div",{className:"col-md-5 mt-3",children:[Object(h.jsx)(m.b,{name:"documento".concat(e),type:"file",className:"form-control-file",onChange:function(e){setTimeout(e.target.select.bind(G(e)))}}),Object(h.jsx)(m.a,{name:"documento".concat(e),component:"span",className:"text-danger"})]})]},e)})),x.documentos?Object(h.jsx)("span",{className:"form-row mb-3",children:Object(h.jsxs)("table",{className:"table table-striped table-hover",children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{scope:"col",children:"Nombre"}),Object(h.jsx)("th",{scope:"col",children:"Documento"})]})}),Object(h.jsx)("tbody",{children:Object.values(x.documentos).map((function(e,t){return Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:e.nombre}),Object(h.jsx)("td",{children:Object(h.jsx)("a",{href:e.documento,target:"_blank",children:Object(h.jsx)("span",{className:"text-dark",children:e.documento})})})]},t)}))})]})}):""]}),"evaluar"==u?Object(h.jsxs)("div",{className:"col-md-12 mb-3",children:[Object(h.jsxs)("label",{htmlFor:"observaciones",children:["Observaciones",Object(h.jsx)("b",{className:"text-danger",children:"*"})]}),Object(h.jsx)(m.b,{name:"observaciones",type:"text",className:"form-control",onBlur:function(e){return G(e)},required:!0}),Object(h.jsx)(m.a,{name:"observaciones",component:"span",className:"text-danger"})]}):""]}),Object(h.jsx)("div",{className:"text-center",children:""==x.status?Object(h.jsx)(y.a,{variant:"primary",type:"submit",children:"Guardar Prospecto"}):""})]})})})}var A=a(118),w=a.n(A),F=a(44),E=a(120),B=a.n(E),T=(a(250),function(e){return Object(h.jsx)(l.DefaultToastContainer,Object(b.a)(Object(b.a)({},e),{},{style:{zIndex:9999}}))});function k(e){var t=e.idProspecto,a=e.setidProspecto,n=Object(c.useContext)(g),s=n.handleShowModal,o=n.sethandleShowModal,r=n.titleModal,i=n.prospectoAccion,d=n.setProspectoAccion,b=Object(c.useState)(!1),m=Object(j.a)(b,2);m[0],m[1];return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("div",{className:"text-center",children:Object(h.jsx)(y.a,{variant:"outline-success",onClick:function(){d("nuevo"),o(!0)},children:"Capturar Prospecto"})}),Object(h.jsxs)(F.a,{show:s,onHide:function(){o(!1),a(null)},dialogClassName:"mod","aria-labelledby":"example-custom-modal-styling-title",backdrop:"static",keyboard:"nuevo"!=i,closeButton:!1,children:[Object(h.jsx)(F.a.Header,{className:"d-flex justify-content-center",children:Object(h.jsx)(F.a.Title,{children:r})}),Object(h.jsx)(F.a.Body,{children:Object(h.jsx)(l.ToastProvider,{components:{ToastContainer:T},children:Object(h.jsx)(C,{idProspecto:t,sethandleShowModal:o})})}),Object(h.jsx)(F.a.Footer,{className:"d-flex justify-content-center",children:Object(h.jsx)(y.a,{variant:"outline-danger",onClick:function(){"nuevo"==i?B.a.mixin({customClass:{cancelButton:"btn btn-success",confirmButton:"btn btn-danger mr-2"},buttonsStyling:!1}).fire({title:"Saldr\xe1 de la pantalla de captura de prospectos y ning\xfan dato ser\xe1 guardado",text:"Si sale perder\xe1 toda la captura.",icon:"warning",showClass:{popup:"animate__animated animate__fadeInDown"},showCancelButton:!0,confirmButtonText:"Salir",cancelButtonText:"Seguir editando"}).then((function(e){e.isConfirmed&&(o(!1),a(null))})):(o(!1),a(null))},children:"Salir"})})]}),Object(h.jsx)("span",{children:t||""})]})}a(252);function R(){var e=Object(c.useContext)(g),t=e.prospectos,a=e.sethandleShowModal,s=e.setProspectoAccion,o=e.getAllProspects,r=Object(c.useState)(),l=Object(j.a)(r,2),i=l[0],d=l[1],b=n.a.useState(!1),m=Object(j.a)(b,2),u=(m[0],m[1],Object(c.useState)([])),O=Object(j.a)(u,2),p=O[0],x=O[1],f=[{name:"Nombre del prospecto",selector:"nombreProspecto",sortable:!0,grow:.6,center:!0},{name:"Primer Apellido",selector:"primerApellido",sortable:!0,center:!0,grow:.5},{name:"Segundo Apellido",selector:"segundoApellido",sortable:!0,grow:.5,center:!0},{name:"Estatus",selector:"status",sortable:!0,center:!0},{name:"Acciones",cell:function(e){return Object(h.jsx)(y.a,{variant:"outline-success btn-sm mr-2",onClick:function(){return v(e.id,"evaluar")},children:"Evaluar"})}}],v=function(e,t){s(t),d((function(t){return e})),a(!0)};Object(c.useEffect)((function(){o()}),[]),Object(c.useEffect)((function(){x(t)}),[t]);var N=Object(h.jsx)(w.a,{title:"Lista de Prospectos",columns:f,data:p,pagination:!0,paginationComponentOptions:{rowsPerPageText:"Filas por P\xe1gina",rangeSeparatorText:"de",selectAllRowsItem:!0,selectAllRowsItemText:"Todos"},fixedHeader:!0,striped:!0,pointerOnHover:!0,subHeader:!0,dense:!0,highlightOnHover:!0,onRowClicked:function(e){return v(e.id,"visualizar")},noDataComponent:"No hay datos capturados",defaultPageSize:2});return Object(h.jsxs)(h.Fragment,{children:[N,Object(h.jsx)(k,{idProspecto:i,setidProspecto:d})]})}var D=a(121);var z=Object(D.hot)((function(){return Object(c.useContext)(g).handleProspects,Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(l.ToastProvider,{}),Object(h.jsx)(R,{})]})}));o.a.render(Object(h.jsx)(r.a,{children:Object(h.jsx)(v,{children:Object(h.jsx)(z,{})})}),document.getElementById("root"))}},[[256,1,2]]]);
//# sourceMappingURL=main.0546e3e2.chunk.js.map