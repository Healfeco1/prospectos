(this.webpackJsonpconcredito=this.webpackJsonpconcredito||[]).push([[0],{249:function(e,t,a){},251:function(e,t,a){},255:function(e,t,a){"use strict";a.r(t);var c=a(1),n=a.n(c),s=a(26),o=a.n(s),r=a(121),l=a(32),i=a(24),d=a(22),b=a(14),j=a(15),m=a(10),u=a(25);u.a.initializeApp({apiKey:"AIzaSyAkxZMP6KJnsCKFqGbgOpZuBwHfb-ysy3c",authDomain:"concredito-f5512.firebaseapp.com",databaseURL:"https://concredito-f5512-default-rtdb.firebaseio.com",projectId:"concredito-f5512",storageBucket:"concredito-f5512.appspot.com",messagingSenderId:"877734757930",appId:"1:877734757930:web:ed8bb0372f15bb8819e553",measurementId:"G-7K32XWFZ1F"}),u.a.analytics(),u.a.auth();u.a;var O=function(e){var t=[];u.a.database().ref("prospectos").on("value",(function(a){var c=a.val();if(c)for(var n=0,s=Object.entries(c);n<s.length;n++){var o=s[n],r=Object(b.a)(Object(b.a)({},o[1]),{},Object(d.a)({},"id",o[0]));t.push(r),e(t)}}))},x=function(e,t){var a={};return u.a.database().ref("prospectos/".concat(e)).once("value").then((function(e){var c=e.val();t(c),a=c})),a},p=function(e,t){JSON.stringify(t);var a=u.a.database().ref("/prospectos/".concat(t));Object.entries(e).map((function(e){console.log(e),a.update(Object(d.a)({},e[0],e[1]))}))},f=function(e){e.status="Enviado";var t=u.a.database().ref("prospectos").push(e).key;e.documentos&&Object.values(e.documentos).map((function(e,a){var c=e.documento,n=u.a.storage().ref(),s=t+"/"+c.name,o=n.child(s).put(c);o.on("",(function(e){}),(function(e){}),(function(){o.snapshot.ref.getDownloadURL().then((function(e){console.log("File available at",e),u.a.database().ref("prospectos/"+t+"/documentos/"+a+"/documento").set(e)}))}))}))},h=a(4);function v(e){var t=Object(c.useState)([]),a=Object(j.a)(t,2),n=a[0],s=a[1],o=Object(c.useState)(!1),r=Object(j.a)(o,2),l=r[0],i=r[1],d=function(){O(s)};Object(c.useEffect)((function(){d()}),[]);return Object(h.jsx)(g.Provider,{value:{getAllProspects:d,resProspectos:[],prospectos:n,getDataIdProspecto:function(e,t){x(e,t)},handledSaveProspect:function(e){f(e),d()},handledUpdateProspect:function(e,t){p(e,t)},sethandleShowModal:i,handleShowModal:l},children:e.children})}var g=n.a.createContext(),N=a(85),P=a(117),y=a(2),S=a(40);function w(e){var t=e.idProspecto,a=e.sethandleShowModal,n=Object(c.useContext)(g),s=n.getDataIdProspecto,o=n.handledSaveProspect,r=n.handledUpdateProspect,u=Object(c.useState)({nombreProspecto:"",primerApellido:"",segundoApellido:"",calle:"",numero:"",colonia:"",codigoPostal:"",telefono:"",rfc:"",observaciones:"",status:"",documentos:""}),O=Object(j.a)(u,2),x=O[0],p=O[1],f=Object(c.useRef)(x),v=Object(c.useState)([]),w=Object(j.a)(v,2),C=w[0],F=w[1],A=Object(l.useToasts)().addToast,B=Object(c.useState)(0),k=Object(j.a)(B,2),E=k[0],R=k[1],T=Object(c.useState)([]),D=Object(j.a)(T,2),I=D[0],z=D[1],M=Object(c.useState)([]),H=Object(j.a)(M,2),L=H[0],_=H[1],J=Object(c.useState)([]),K=Object(j.a)(J,2);K[0],K[1];Object(c.useEffect)((function(){t&&s(t,p)}),[]);function U(e){var t;return e||(t="Campo Requerido"),t}Object(c.useEffect)((function(){}),[E]);var q=function(e){var t="documentoName".concat(E-1),a="documento".concat(E-1);if(e.target.name==t&&_(Object(b.a)(Object(b.a)({},L),{},Object(d.a)({},E-1,{nombre:e.target.value}))),e.target.name==a){_(Object(b.a)(Object(b.a)({},L),{},Object(d.a)({},E-1,Object(b.a)(Object(b.a)({},L[E-1]),{},{documento:e.target.files[0]}))))}var c=C,n=Object(b.a)(Object(b.a)({},c),{},Object(d.a)({},e.target.name,e.target.value));F(n)};Object(c.useEffect)((function(){console.log(L)}),[L]);return Object(c.useEffect)((function(){}),[f.current]),Object(h.jsx)(h.Fragment,{children:Object(h.jsx)(m.d,{innerRef:f,enableReinitialize:!0,initialValues:x,onSubmit:function(e,t){return function(e,t,c){e=Object(b.a)(Object(b.a)({},e),{},{documentos:L}),o(e),a(!1),t()}(e,t.resetForm)},validationSchema:N.a({telefono:N.b().max(10,"Este campo solo acepta mximo 10 caracteres")}),children:Object(h.jsxs)(m.c,{children:[Object(h.jsxs)("div",{className:"col-md-10 mb-3 d-flex justify-content-between",children:[Object(h.jsxs)("div",{children:[Object(h.jsx)("label",{htmlFor:"status",className:"mr-2",children:"Estatus"}),Object(h.jsx)(m.b,{name:"status",type:"text",className:"text-white text-center ".concat("Autorizado"==x.status?"bg-success":"Rechazado"==x.status?"bg-danger":"Enviado"==x.status?"bg-secondary":""),disabled:!0})]}),""!=x.status&&"Enviado"==x.status?Object(h.jsxs)("div",{className:"col-md-8",children:[Object(h.jsx)(S.a,{variant:"outline-success btn-sm mr-2",onClick:function(){return function(){var e=Object(b.a)(Object(b.a)({},C),{},{status:"Autorizado"});r(e,t),s(t,p)}()},children:"Autorizar"}),Object(h.jsx)(S.a,{variant:"outline-danger btn-sm",onClick:function(){return function(){if(0==x.observaciones.length)C.observaciones||A("Captura el campo: Observaciones, es obligatorio *",{appearance:"error",autoDismiss:!0});else{var e=Object(b.a)(Object(b.a)({},C),{},{status:"Rechazado"});r(e,t),s(t,p),F([])}}()},children:"Rechazar"})]}):""]}),Object(h.jsxs)("div",{className:"form-row m-1",children:[Object(h.jsxs)("div",{className:"col-md-4 mb-3",children:[Object(h.jsxs)("label",{htmlFor:"nombreProspecto",children:["Nombre del prospecto",Object(h.jsx)("b",{className:"text-danger",children:"*"})]}),Object(h.jsx)(m.b,{name:"nombreProspecto",type:"text",className:"form-control",validate:U,onBlur:function(e){return q(e)},disabled:""!=x.status?"disabled":""}),Object(h.jsx)(m.a,{name:"nombreProspecto",component:"span",className:"text-danger"})]}),Object(h.jsxs)("div",{className:"col-md-4 mb-3",children:[Object(h.jsxs)("label",{htmlFor:"primerApellido",children:["Primer apellido",Object(h.jsx)("b",{className:"text-danger",children:"*"})]}),Object(h.jsx)(m.b,{name:"primerApellido",type:"text",className:"form-control",validate:U,onBlur:function(e){return q(e)},disabled:""!=x.status?"disabled":""}),Object(h.jsx)(m.a,{name:"primerApellido",component:"span",className:"text-danger"})]}),Object(h.jsxs)("div",{className:"col-md-4 mb-3",children:[Object(h.jsx)("label",{htmlFor:"segundoApellido",children:"Segundo Apellido"}),Object(h.jsx)(m.b,{name:"segundoApellido",type:"text",className:"form-control",onBlur:function(e){return q(e)},disabled:""!=x.status?"disabled":""})]}),Object(h.jsxs)("div",{className:"col-md-5 mb-3",children:[Object(h.jsxs)("label",{htmlFor:"calle",children:["Calle",Object(h.jsx)("b",{className:"text-danger",children:"*"})]}),Object(h.jsx)(m.b,{name:"calle",type:"text",className:"form-control",validate:U,onBlur:function(e){return q(e)},disabled:""!=x.status?"disabled":""}),Object(h.jsx)(m.a,{name:"calle",component:"span",className:"text-danger"})]}),Object(h.jsxs)("div",{className:"col-md-3 mb-3",children:[Object(h.jsxs)("label",{htmlFor:"numero",children:["N\xfamero",Object(h.jsx)("b",{className:"text-danger",children:"*"})]}),Object(h.jsx)(m.b,{name:"numero",type:"number",className:"form-control",validate:U,onBlur:function(e){return q(e)},disabled:""!=x.status?"disabled":""}),Object(h.jsx)(m.a,{name:"numero",component:"span",className:"text-danger"})]}),Object(h.jsxs)("div",{className:"col-md-4 mb-3",children:[Object(h.jsxs)("label",{htmlFor:"colonia",children:["Colonia",Object(h.jsx)("b",{className:"text-danger",children:"*"})]}),Object(h.jsx)(m.b,{name:"colonia",type:"text",className:"form-control",validate:U,onBlur:function(e){return q(e)},disabled:""!=x.status?"disabled":""}),Object(h.jsx)(m.a,{name:"colonia",component:"span",className:"text-danger"})]}),Object(h.jsxs)("div",{className:"col-md-3 mb-3",children:[Object(h.jsxs)("label",{htmlFor:"codigoPostal",children:["CP",Object(h.jsx)("b",{className:"text-danger",children:"*"})]}),Object(h.jsx)(m.b,{name:"codigoPostal",type:"number",className:"form-control",validate:U,onBlur:function(e){return q(e)},disabled:""!=x.status?"disabled":""}),Object(h.jsx)(m.a,{name:"codigoPostal",component:"span",className:"text-danger"})]}),Object(h.jsxs)("div",{className:"col-md-4 mb-3",children:[Object(h.jsxs)("label",{htmlFor:"telefono",children:["Tel\xe9fono",Object(h.jsx)("b",{className:"text-danger",children:"*"})]}),Object(h.jsx)(m.b,{name:"telefono",type:"number",className:"form-control",validate:U,onBlur:function(e){return q(e)},disabled:""!=x.status?"disabled":"",maxLength:"10"}),Object(h.jsx)(m.a,{name:"telefono",component:"span",className:"text-danger"})]}),Object(h.jsxs)("div",{className:"col-md-5 mb-3",children:[Object(h.jsxs)("label",{htmlFor:"rfc",children:["RFC",Object(h.jsx)("b",{className:"text-danger",children:"*"})]}),Object(h.jsx)(m.b,{name:"rfc",type:"text",className:"form-control",validate:U,onBlur:function(e){return q(e)},disabled:""!=x.status?"disabled":""}),Object(h.jsx)(m.a,{name:"rfc",component:"span",className:"text-danger"})]}),Object(h.jsxs)("div",{className:"col-12 mb-3",children:[Object(h.jsx)("label",{htmlFor:"documentos",children:"Documentos"}),Object(h.jsx)(y.b.Provider,{value:{size:"1em",className:"mb-2"},children:Object(h.jsx)("span",{onClick:function(e){return function(e){var t;e.preventDefault(),Object(b.a)(Object(b.a)({},x),{},(t={},Object(d.a)(t,"documentoName".concat(E),""),Object(d.a)(t,"documento".concat(E),""),t));var a=[].concat(Object(i.a)(I),[E]);z(a),R(E+1)}(e)},children:""!=x.status?"":Object(h.jsx)(P.a,{})})})]}),Object(h.jsxs)("div",{className:"col-md-12 mb-3",children:[I.map((function(e){return Object(h.jsxs)("span",{className:"form-row mb-3 d-flex align-items-center text-center",children:[Object(h.jsxs)("div",{className:"form-row col-md-6 mb-3 ml-5",children:[Object(h.jsxs)("label",{htmlFor:"documentoName".concat(e),children:["Nombre del documento",Object(h.jsx)("b",{className:"text-danger",children:"*"})]}),Object(h.jsx)(m.b,{name:"documentoName".concat(e),type:"text",className:"form-control",validate:U,onBlur:function(e){return q(e)}}),Object(h.jsx)(m.a,{name:"documentoName".concat(e),component:"span",className:"text-danger"})]}),Object(h.jsxs)("div",{className:"col-md-5 mt-3",children:[Object(h.jsx)(m.b,{name:"documento".concat(e),type:"file",className:"form-control-file",onBlur:function(e){return q(e)},onChange:function(e){return console.log("file: ",e.target.value)}}),Object(h.jsx)(m.a,{name:"documento".concat(e),component:"span",className:"text-danger"})]})]},e)})),x.documentos?Object(h.jsx)("span",{className:"form-row mb-3",children:Object(h.jsxs)("table",{className:"table table-striped table-hover",children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{scope:"col",children:"Nombre"}),Object(h.jsx)("th",{scope:"col",children:"Documento"})]})}),Object(h.jsx)("tbody",{children:Object.values(x.documentos).map((function(e){return Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:e.nombre}),Object(h.jsx)("td",{children:Object(h.jsx)("a",{href:e.documento,target:"_blank",children:Object(h.jsx)("span",{className:"text-dark",children:e.documento})})})]})}))})]})}):""]}),""!=x.status?Object(h.jsxs)("div",{className:"col-md-12 mb-3",children:[Object(h.jsxs)("label",{htmlFor:"observaciones",children:["Observaciones",Object(h.jsx)("b",{className:"text-danger",children:"*"})]}),Object(h.jsx)(m.b,{name:"observaciones",type:"text",className:"form-control",onBlur:function(e){return q(e)},required:!0}),Object(h.jsx)(m.a,{name:"observaciones",component:"span",className:"text-danger"})]}):""]}),Object(h.jsx)("div",{className:"text-center",children:""==x.status?Object(h.jsx)(S.a,{variant:"primary",type:"submit",children:"Guardar Prospecto"}):""})]})})})}var C=a(118),F=a.n(C),A=a(44),B=a(120),k=a.n(B),E=(a(249),function(e){return Object(h.jsx)(l.DefaultToastContainer,Object(b.a)(Object(b.a)({},e),{},{style:{zIndex:9999}}))});function R(e){var t,a=e.idProspecto,n=e.setidProspecto,s=Object(c.useContext)(g),o=s.handleShowModal,r=s.sethandleShowModal,i=Object(c.useState)(!1),b=Object(j.a)(i,2);b[0],b[1];return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("div",{className:"text-center",children:Object(h.jsx)(S.a,{variant:"outline-success",onClick:function(){r(!0)},children:"Capturar Prospecto"})}),Object(h.jsxs)(A.a,(t={show:o,onHide:function(){r(!1),n(null)},dialogClassName:"mod","aria-labelledby":"example-custom-modal-styling-title",keyboard:!0,backdrop:"static"},Object(d.a)(t,"keyboard",!1),Object(d.a)(t,"children",[Object(h.jsx)(A.a.Header,{children:Object(h.jsx)(A.a.Title,{children:"Modal heading"})}),Object(h.jsx)(A.a.Body,{children:Object(h.jsx)(l.ToastProvider,{components:{ToastContainer:E},children:Object(h.jsx)(w,{idProspecto:a,sethandleShowModal:r})})}),Object(h.jsx)(A.a.Footer,{className:"d-flex justify-content-center",children:Object(h.jsx)(S.a,{variant:"outline-danger",onClick:function(){k.a.mixin({customClass:{cancelButton:"btn btn-success",confirmButton:"btn btn-danger mr-2"},buttonsStyling:!1}).fire({title:"Saldr\xe1 de la pantalla de captura de prospectos y ning\xfan dato ser\xe1 guardado",text:"Si sale perder\xe1 toda la captura.",icon:"warning",showClass:{popup:"animate__animated animate__fadeInDown"},showCancelButton:!0,confirmButtonText:"Salir",cancelButtonText:"Seguir editando"}).then((function(e){e.isConfirmed&&(r(!1),n(null))}))},children:"Salir"})})]),t)),Object(h.jsx)("span",{children:a||""})]})}a(251);function T(){var e=Object(c.useContext)(g),t=e.prospectos,a=e.sethandleShowModal,s=(e.getAllProspects,Object(c.useState)()),o=Object(j.a)(s,2),r=o[0],l=o[1],i=n.a.useState(!1),d=Object(j.a)(i,2),b=(d[0],d[1],Object(c.useState)(t)),m=Object(j.a)(b,2),u=m[0],O=m[1];Object(c.useEffect)((function(){}),[]),Object(c.useLayoutEffect)((function(){O(t)}),[t]);var x=Object(h.jsx)(F.a,{title:"Lista de Prospectos",columns:[{name:"Nombre del prospecto",selector:"nombreProspecto",sortable:!0,grow:.6,center:!0},{name:"Primer Apellido",selector:"primerApellido",sortable:!0,center:!0,grow:.5},{name:"Segundo Apellido",selector:"segundoApellido",sortable:!0,grow:.5,center:!0},{name:"Estatus",selector:"status",sortable:!0,center:!0}],data:u,initalData:u,pagination:!0,paginationComponentOptions:{rowsPerPageText:"Filas por P\xe1gina",rangeSeparatorText:"de",selectAllRowsItem:!0,selectAllRowsItemText:"Todos"},fixedHeader:!0,striped:!0,pointerOnHover:!0,subHeader:!0,dense:!0,highlightOnHover:!0,onRowClicked:function(e){return t=e.id,l((function(e){return t})),void a(!0);var t},noDataComponent:"No hay datos capturados"});Object(c.useRef)(t);return Object(c.useEffect)((function(){}),[u]),Object(h.jsxs)(h.Fragment,{children:[x,Object(h.jsx)(R,{idProspecto:r,setidProspecto:l})]})}var D=function(){return Object(c.useContext)(g).handleProspects,Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(l.ToastProvider,{}),Object(h.jsx)(T,{})]})};o.a.render(Object(h.jsx)(r.a,{children:Object(h.jsx)(v,{children:Object(h.jsx)(D,{})})}),document.getElementById("root"))}},[[255,1,2]]]);
//# sourceMappingURL=main.fa7ae9d8.chunk.js.map